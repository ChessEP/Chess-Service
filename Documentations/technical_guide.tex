%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     STYLE POUR LES EXPOSES TECHNIQUES 
%         3e année INSA de Rennes
%
%             NE PAS MODIFIER
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper,11pt]{article}

\usepackage{exptech}       % Fichier (./exptech.sty) contenant les styles pour 
                           % l'expose technique (ne pas le modifier)
\usepackage{url}

%\linespread{1,6}          % Pour une version destinée à un relecteur,
                           % décommenter cette commande (double interligne) 
                           
% UTILISEZ SPELL (correcteur orthographique) à accès simplifié depuis XEmacs

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{ \textbf{Distributed Chess Service - Guide technique} }
\markright{Distributed Chess Service - Guide technique} 
                           % Pour avoir le titre de l'expose sur chaque page

\author{Paul \textsc{Chaignon}, Thomas \textsc{François}, \\
        Damien \textsc{Le Guen}, Clément \textsc{Gautrais}, \\
				Benoit \textsc{Travers} \\
        \\
        Encadrants : Loïc \textsc{Hélouët}, Yann \textsc{Ricquebourg}}

\date{}                    % Ne pas modifier
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}
\maketitle{}

\section{Organisation générale}

    Le serveur central du projet permet de coordonner les différents appels entre : les requêtes des clients d'une part, et les recherches de meilleur coup de chaque ressource d'autre part.

\section{Requêtes entrantes RESTful}
    Afin d'orchestrer les différents appels entre chaque partie, le projet utilise le framework Grizzly, basé sur une architecture de type RESTful. [définition RESTful]
    
    Le serveur Grizzly est lançé par la classe CentralServerResourceDeployer, qui à la reception d'une requête entrante va transmettre son décodage à la classe CentralServerResource. Cette dernière contient le coeur de l'architecture REST. En fonction du type de la requête reçue (GET, POST, UPDATE, DELETE...) celle-ci exécute l'action correspondante puis renvoie la réponse au client.

\section{Gestion des ressources et des parties de jeux}

    L'utilisation de bases de données s'est révélée nécessaire pour deux parties du serveur. central. La première liste toutes les ressources à interroger pour obtenir le meilleur coup. La deuxième base enregistre quand à elle chaque partie se déroulant sur le serveur. Ainsi, en plus d'obtenir des informations sur le nombre de parties joués et leur déroulement, il est possible d'établir des statistiques précises sur les ressources choisies par le serveur pour donner le meilleur coup. Le framework DatabaseManager unifie l'utilisation de ces bases de données SQLite.

	

    Les ressources peuvent être de trois types : bases de données d'ouverture de partie (les meilleurs débuts de partie des grands champions d'échecs), bots (évaluant statistiquement le meilleur coup, efficace pour le milieu de partie), et bases de fermeture (meilleurs fin de parties). En interne, chacune possède une réputation servant à l'algorithme de sélection du coup à renvoyer au client.

\section{Outil graphique de configuration du serveur et de gestion des ressources}
	[a dégager...]
    Afin de faciliter la maintenance du serveur par le maximum de personnes, une interface graphique a été mise en place. En plus d'aider à configurer les différents paramètres du serveur (port d'écoute des requêtes, temps maximum d'attente des réponses, nom des bases de données...), cet outil permet de paramétrer la liste des ressources disponibles et de modifier leur propriétés.

    Cet outil utilise la librairie SWT pour l'affichage de l'interface utilisateur.

\section{Interface client}

\section{Calcul du meilleur Coup}
Le calcul du meilleur coup constitue, avec les appels aux ressources, le principal contenu du serveur central. Ce calcul est effectué en plusieurs étapes. Tout d'abord, le serveur central va demander à chaque ressource (instance de classe dérivée de la classe Resource) de mettre à jour la liste de coup qu'elle propose. Pour cela, la ressource effectuer un requête GET à son uri. Cette requête GET va lui permettre de récupérer les coups que la ressource distante (accessible via l'interface php associée) lui propose, au format JSON. Ce JSON va ensuite être analysé syntaxiquement et les suggestions de coup (instances de classes dérivées de MoveSuggestion) créées vont former la liste de coups de la ressource. En plus de stocker les informations renvoyées par les ressources externes dans les suggestion de coups, on calcule un score pour chaque suggestion. Ce score est calculé en prenant en compte les informations de la ressources ainsi que des statistiques (accessibles via StatsManager) des parties précédentes (voir rapport pour les formules). Une fois que toutes les ressources ont mis à jour leur liste de coups, le serveur central va calculer un score associé à chaque coup, prenant en compte les listes de coups de toutes les ressources (voir rapport pour les formules). Une fois ces scores calculés, le coup qui a le score le plus élevé est renvoyé au client. Une fois le meilleur coup déterminé, les statistiques sur les suggestion de coups sont mises à jour grâce à StatsManager.

\section{Evolution des confiances des ressources}
Comme précisé dans le rapport, nous attribuons une certaine confiance à chaque ressource afin de pondérer son l'influence en fonction de la confiance que nous lui accordons. Le principe de confiance est semblable à un système de récompense. Si une ressource nous permet de gagner une partie, elle est récompensée positivement (la confiance que nous lui accordons augmente); à l'inverse, si elle nous a conseillé lors d'une défaite, elle est récompensée négativement. Seules les ressources noous ayant proposé au moins un coup que nous avons joué sont récompensées. Cependant, chaque ressource propose généralement plusieurs coups pour une unique situation. Il faut donc pondérer la récompense en fonction de la confiance que la ressource apporte dans le coup que nous avons choisi de jouer. Ainsi, si le score (celui que nous calculons) associé à un coup est maximum pour la ressource, on considérera que la ressource a confiance en ce coup. A l'inverse, si le coup a un score faible par rapport au score des autres coups que la ressource propose, nous considérerons que le ressource a peu confiance en ce coup. Toutes les confiances des coups d'une partie sont stockées dans la table moves. A la fin d'une partie chaque ressource est récompensée proportionnellement à la somme des confiance de tous les coups qu'elle a proposés et que nous avons joués durant cette partie.
	
\end{document}
